<!DOCTYPE html>
<html>
<head>
    <title>Labels</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css" />
</head>
<body>
    <div class="container-left">
        <div id="map"></div>
    </div>
    <div class="container-right">
        <div>
            <h2>Labels</h2>
            <p>
                Set labels by setting the canvas properties:
            </p>
            <p>
                <label for="fillStyle">fillStyle: </label>
                <input type="color" value="#BF3F3F" id="fillStyle" name="input" /><br />

                <label for="font">font: </label>
                <input type="text" value="12px arial bold" id="font" name="input" /><br />

                <label for="textAlign">textAlign: </label>
                <select id="textAlign" name="input">
                    <option value="start" selected="selected">start</option>
                    <option value="end">end</option>
                    <option value="left">left</option>
                    <option value="right">right</option>
                    <option value="center">center</option>
                </select><br />

                <label for="textBaseline">textBaseline: </label>
                <select id="textBaseline" name="input">
                    <option value="alphabetic" selected="selected">alphabetic</option>
                    <option value="top">top</option>
                    <option value="hanging">hanging</option>
                    <option value="middle">middle</option>
                    <option value="ideographic">ideographic</option>
                    <option value="bottom">bottom</option>
                </select><br />

                <label for="direction">direction: </label>
                <select id="direction" name="input">
                    <option value="inherit" selected="selected">inherit</option>
                    <option value="ltr">ltr</option>
                    <option value="rtl">rtl</option>                    
                </select><br />
            </p>
        </div>
    </div>

    <script src="../dist/vector-tiles-google-maps.js"></script>
    <script type="text/javascript">
        var map;
        var mvtSource;

        function InitGoogleMap() {
            map = new google.maps.Map(document.getElementById("map"), {
                center: { lat: -5, lng: 27.4 },
                zoom: 5
            });
            // if tiles have not been loaded, GetTile will trigger twice.
            google.maps.event.addListenerOnce(map, 'tilesloaded', function () {
                InitVectorTiles();
            });
        }


        function GetLabel() {
            return function (feature) {
                var text = feature.properties.id;
                return {
                    fillStyle: document.getElementById("fillStyle").value,
                    font: document.getElementById("font").value,
                    textAlign: document.getElementById("textAlign").value,
                    textBaseline: document.getElementById("textBaseline").value,
                    direction: document.getElementById("direction").value,
                    text: text
                };
            };
        }

        function InitVectorTiles() {
            var options = {
                url: "http://spatialserver.spatialdev.com/services/vector-tiles/GAUL_FSP/{z}/{x}/{y}.pbf",
                visibleLayers: ["GAUL0"],
                //debug:true,
                style: function() {
                    return {
                        fillStyle: 'rgba(49,79,79,0)',
                        strokeStyle: 'rgba(63,63,191,1)',
                        lineWidth: 2
                    }
                },
                label: GetLabel(),
            };

            mvtSource = new MVTSource(map, options);
            map.overlayMapTypes.insertAt(0, mvtSource);

            var inputs = document.getElementsByName("input");
            inputs.forEach(function (input) {
                input.addEventListener("change", UpdateStyle);
            });
        }

        function UpdateStyle() {
            var label = GetLabel();
            mvtSource.setLabel(label);
        }

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDnkD94apUwQA0gIWMoMxRuHQarhbBNrf0&callback=InitGoogleMap&libraries=&v=weekly"
            defer></script>

</body>
</html>
